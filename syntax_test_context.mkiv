% SYNTAX TEST "Packages/simpleConTeXt/ConTeXt.sublime-syntax"

% <- text.tex.context

% ===== GENERAL CONTROL SEQUENCES =====
  \starttext
% ^          punctuation.definition.backslash.context
% ^^^^^^^^^^ support.function.general.context meta.other.control.word.context

  \controlwordwitharguments [a=b] {...} [c=d] {...}
% ^                                                 punctuation.definition.backslash.context
% ^^^^^^^^^^^^^^^^^^^^^^^^^                         support.function.general.context meta.other.control.word.context
%                           ^                       punctuation.section.brackets.begin.context
%                            ^                      variable.parameter.context
%                             ^                     keyword.operator.assignment.context
%                              ^                    meta.other.value.context
%                               ^                   punctuation.section.brackets.end.context
%                           ^^^^^                   meta.brackets.context
%                                 ^                 punctuation.section.braces.begin.context
%                                     ^             punctuation.section.braces.end.context
%                                 ^^^^^             meta.braces.context
%                                       ^           punctuation.section.brackets.begin.context
%                                        ^          variable.parameter.context
%                                         ^         keyword.operator.assignment.context
%                                          ^        meta.other.value.context
%                                           ^       punctuation.section.brackets.end.context
%                                       ^^^^^       meta.brackets.context
%                                             ^     punctuation.section.braces.begin.context
%                                                 ^ punctuation.section.braces.end.context
%                                             ^^^^^ meta.braces.context

  \%
% ^  punctuation.definition.backslash.context
% ^^ constant.other.symbol.context - meta.other.control.word.context

  \argumentsafterzerolinebreaks[k=v]
%                              ^     punctuation.section.brackets.begin.context
%                               ^    variable.parameter.context
%                                ^   keyword.operator.assignment.context
%                                 ^  meta.other.value.context
%                                  ^ punctuation.section.brackets.end.context
%                              ^^^^^ meta.brackets.context

  \argumentsafteronelinebreak
    [k=v]
%   ^     punctuation.section.brackets.begin.context
%    ^    variable.parameter.context
%     ^   keyword.operator.assignment.context
%      ^  meta.other.value.context
%       ^ punctuation.section.brackets.end.context
%   ^^^^^ meta.brackets.context

  \argumentsaftertwolinebreaks

    [k=v]
%   ^     - punctuation.section.brackets.begin.context
%    ^    - variable.parameter.context
%     ^   - keyword.operator.assignment.context
%      ^  - meta.other.value.context
%       ^ - punctuation.section.brackets.end.context
%   ^^^^^ - meta.brackets.context

  \argumentwithsomedimensions
    [key1=10pt, key2=1cm, key3=1.2em]
%   ^                                 punctuation.section.brackets.begin.context
%    ^^^^                             variable.parameter.context
%        ^                            keyword.operator.assignment.context
%         ^^                          constant.numeric.context
%           ^^                        keyword.other.unit.context
%         ^^^^                        meta.other.value.context
%             ^                       punctuation.separator.comma.context
%               ^^^^                  variable.parameter.context
%                   ^                 keyword.operator.assignment.context
%                    ^                constant.numeric.context
%                     ^^              keyword.other.unit.context
%                    ^^^              meta.other.value.context
%                       ^             punctuation.separator.comma.context
%                         ^^^^        variable.parameter.context
%                             ^       keyword.operator.assignment.context
%                              ^^^    constant.numeric.context
%                                 ^^  keyword.other.unit.context
%                              ^^^^^  meta.other.value.context
%                                   ^ punctuation.section.brackets.end.context
%   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.context

% ===== LUA =====
\startluacode
  context(
    5 % 2
  %   ^^^ - comment.line.percentage.context
  )
  -- context("b")
  % <- comment.line.double-dash.lua
\stopluacode

\startlua
  context(
    5 % 2
  %   ^^^ comment.line.percentage.context
  )
  -- context("b")
  % <- comment.line.double-dash.lua
\stoplua

\ctxlua{
  context(
    5 % 2
  %   ^^^ comment.line.percentage.context
  )
  -- context("b")
  % <- comment.line.double-dash.lua
}


% ===== METAPOST/METAFUN =====
\startMPcode{name}
%           ^^^^^^ meta.braces.context - source.metapost.metafun.embedded.context
  draw unitdiamond scaled 5pt withcolor blue;
  % <- source.metapost.metafun.embedded.context
\stopMPcode

\startuniqueMPgraphic{foo}{x, y}
%                    ^^^^^       meta.braces.context
%                         ^^^^^^ meta.braces.context
%                    ^^^^^^^^^^^ - source.metapost.metafun.embedded.context
  draw unitcircle scaled 1cm withcolor red;
  % <- source.metapost.metafun.embedded.context
\stopuniqueMPgraphic

\startreusableMPgraphic {foo} {x, y}
%                       ^^^^^        meta.braces.context
%                             ^^^^^^ meta.braces.context
%                       ^^^^^^^^^^^^ - source.metapost.metafun.embedded.context
  draw unitsquare scaled 55mm withcolor yellow;
  % <- source.metapost.metafun.embedded.context
\stopreusableMPgraphic


% ===== MATH =====
Adding $1$, \m{2} and \math[three]{3} gives \mathematics{6}.
%      ^                                                   punctuation.section.dollar.begin.context
%       ^                                                  meta.environment.math.inline.context
%        ^                                                 punctuation.section.dollar.end.context
%              ^                                           meta.environment.math.inline.context
%                                  ^                       meta.environment.math.inline.context
%                                                        ^ meta.environment.math.inline.context

\startformula[packed] 123456 = xyz \stopformula
%            ^^^^^^^^              meta.brackets.context - meta.environment.math.block.context
%                     ^^^^^^       constant.numeric.context
%                            ^     keyword.operator.math.context
%                              ^^^ string.quoted.other.math.context
%                     ^^^^^^^^^^^^ meta.environment.math.block.context


% ===== VERBATIM =====
The percent sign \type[option=tex]{%} and the hash \type<<#1>> are special.
%                     ^                                        punctuation.section.brackets.begin.context
%                      ^^^^^^                                  variable.parameter.context
%                            ^                                 keyword.operator.assignment.context
%                             ^^^                              meta.other.value.context
%                                ^                             punctuation.section.brackets.end.context
%                     ^^^^^^^^^^^^                             meta.brackets.context
%                                 ^                            punctuation.section.braces.begin.context
%                                  ^                           markup.raw.block.context - comment.line.percentage.context
%                                   ^                          punctuation.section.braces.end.context
%                                 ^^^                          meta.braces.context
%                                                       ^^     punctuation.section.angles.begin.context
%                                                         ^^   markup.raw.block.context - variable.parameter.context
%                                                           ^^ punctuation.section.angles.end.context
%                                                       ^^^^^^ meta.angles.context

\starttyping[option=xml]
%            ^^^^^^      variable.parameter.context
%                  ^     keyword.operator.assignment.context
%           ^^^^^^^^^^^^ meta.brackets.context - markup.raw.block.context
  <cd:command name="MPcolor" file="colo-ini.mkiv">
    <cd:arguments>
      <cd:resolve name="argument-color"/>
    </cd:arguments>
  </cd:command>
  % <- markup.raw.block.context
\stoptyping

\startbuffer
  ... \type{#1} % \anundefinedcontrolsequence
  and \type{%}  % invalid argument #0 commented out
  % <- meta.other.buffer
\stopbuffer


% ===== COMMENTS =====
  % Lorem ipsum
% ^             punctuation.definition.comment.context
% ^^^^^^^^^^^^^ comment.line.percentage.context

\starthiding ... \stophiding
%            ^^^ comment.block.hiding.context


% ===== TEMPLATES =====
\bTABLE
  <?lua for row=1,5 do ?>
% ^^                      punctuation.definition.tag.begin.context
%   ^^^                   entity.name.tag.lua.context
%       ^^^^^^^^^^^^^^    source.lua.embedded.context
%                      ^^ punctuation.definition.tag.end.context
    \bTR
      <?lua for col=1,5 do ?>
        \bTD
          cell (<?lua inject(row) ?>, <?lua inject(col) ?>)
        \eTD
      <?lua end ?>
    \eTR
  <?lua end ?>
\eTABLE


% ===== HEADINGS =====
\startpart[title=Part 1, reference=ref1]
  %       ^                              punctuation.section.brackets.begin.context
  %        ^^^^^                         variable.parameter.context
  %             ^                        keyword.operator.assignment.context
  %              ^^^^^^                  meta.other.value.context meta.other.title.context entity.name.headings.part.context
  %                    ^                 punctuation.separator.comma.context
  %                      ^^^^^^^^^       variable.parameter.context
  %                               ^      keyword.operator.assignment.context
  %                                ^^^^  meta.other.value.context meta.other.reference.context
  %                                    ^ punctuation.section.brackets.end.context
  %       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.brackets.context
  \startchapter[title=Chapter One]
    %                 ^^^^^^^^^^^                                 meta.other.value.context meta.other.title.context entity.name.headings.chapter.context
    \startsection[title={Section I}]
      %                 ^^^^^^^^^^^                               meta.other.value.context meta.other.title.context entity.name.headings.section.context
      \startsubsection[title=Subsection A]
        %                    ^^^^^^^^^^^^                         meta.other.value.context meta.other.title.context entity.name.headings.subsection.context
        \startsubsubsection[title=Subsubsection B]
          %                       ^^^^^^^^^^^^^^^                 meta.other.value.context meta.other.title.context entity.name.headings.subsubsection.context
          \startsubsubsubsection[title=Subsubsubsection C]
            %                          ^^^^^^^^^^^^^^^^^^         meta.other.value.context meta.other.title.context entity.name.headings.subsubsubsection.context
            \startsubsubsubsubsection[title=Subsubsubsubsection D]
              %                             ^^^^^^^^^^^^^^^^^^^^^ meta.other.value.context meta.other.title.context entity.name.headings.subsubsubsubsection.context
              Lorem ipsum.
            \stopsubsubsubsubsection
          \stopsubsubsubsection
        \stopsubsubsection
      \stopsubsection
    \stopsection
  \stopchapter
\stoppart

  \starttitle[title=Title One]
    %               ^^^^^^^^^                                     meta.other.value.context meta.other.title.context entity.name.headings.chapter.context
    \startsubject[title=Subject I]
      %                 ^^^^^^^^^                                 meta.other.value.context meta.other.title.context entity.name.headings.section.context
      \startsubsubject[title=Subsubject A]
        %                    ^^^^^^^^^^^^                         meta.other.value.context meta.other.title.context entity.name.headings.subsection.context
        \startsubsubsubject[title=Subsubsubject B]
          %                       ^^^^^^^^^^^^^^^                 meta.other.value.context meta.other.title.context entity.name.headings.subsubsection.context
          \startsubsubsubsubject[title=Subsubsubsubject C]
            %                          ^^^^^^^^^^^^^^^^^^         meta.other.value.context meta.other.title.context entity.name.headings.subsubsubsection.context
            \startsubsubsubsubsubject[title=Subsubsubsubsubject D]
              %                             ^^^^^^^^^^^^^^^^^^^^^ meta.other.value.context meta.other.title.context entity.name.headings.subsubsubsubsection.context
              Lorem ipsum.
            \stopsubsubsubsubsubject
          \stopsubsubsubsubject
        \stopsubsubsubject
      \stopsubsubject
    \stopsubject
  \stoptitle

\part[ref2]{Part 1}
  %   ^^^^                                             meta.other.reference.context
  %  ^^^^^^                                            meta.brackets.context
  %         ^^^^^^                                     meta.other.title.context entity.name.headings.part.context
\part{Part 2}
  %   ^^^^^^                                           meta.other.title.context entity.name.headings.part.context
  \chapter{Chapter One}
    %      ^^^^^^^^^^^                                 meta.other.title.context entity.name.headings.chapter.context
    \section{Section I}
      %      ^^^^^^^^^                                 meta.other.title.context entity.name.headings.section.context
      \subsection{Subsection A}
        %         ^^^^^^^^^^^^                         meta.other.title.context entity.name.headings.subsection.context
        \subsubsection{Subsubsection B}
          %            ^^^^^^^^^^^^^^^                 meta.other.title.context entity.name.headings.subsubsection.context
          \subsubsubsection{Subsubsubsection C}
            %               ^^^^^^^^^^^^^^^^^^         meta.other.title.context entity.name.headings.subsubsubsection.context
            \subsubsubsubsection{Subsubsubsubsection D}
              %                  ^^^^^^^^^^^^^^^^^^^^^ meta.other.title.context entity.name.headings.subsubsubsubsection.context
              Lorem ipsum.

  \title{Title One}
    %    ^^^^^^^^^                                     meta.other.title.context entity.name.headings.chapter.context
    \subject{Subject I}
      %      ^^^^^^^^^                                 meta.other.title.context entity.name.headings.section.context
      \subsubject{Subsubject A}
        %         ^^^^^^^^^^^^                         meta.other.title.context entity.name.headings.subsection.context
        \subsubsubject{Subsubsubject B}
          %            ^^^^^^^^^^^^^^^                 meta.other.title.context entity.name.headings.subsubsection.context
          \subsubsubsubject{Subsubsubsubject C}
            %               ^^^^^^^^^^^^^^^^^^         meta.other.title.context entity.name.headings.subsubsubsection.context
            \subsubsubsubsubject{Subsubsubsubsubject D}
              %                  ^^^^^^^^^^^^^^^^^^^^^ meta.other.title.context entity.name.headings.subsubsubsubsection.context
              Lorem ipsum.


% ===== MARKUP =====
Lorem \emph{ipsum} dolor {\emph sit} amet, {\em consectetur} adipisicing.
%           ^^^^^                                           markup.italic.emphasis.context
%                               ^^^                         markup.italic.emphasis.context
%                                               ^^^^^^^^^^^ markup.italic.emphasis.context
Lorem \bold{ipsum} dolor {\bold sit} amet, {\bf consectetur} adipisicing.
%           ^^^^^                                           markup.bold.boldface.context
%                               ^^^                         markup.bold.boldface.context
%                                               ^^^^^^^^^^^ markup.bold.boldface.context
Lorem \mono{ipsum} dolor {\mono sit} amet, {\tt consectetur} adipisicing.
%           ^^^^^                                           markup.raw.block.context
%                               ^^^                         markup.raw.block.context
%                                               ^^^^^^^^^^^ markup.raw.block.context

Lorem \quote{ipsum} dolor sit \quotation{amet}, consectetur adipisicing.
%            ^^^^^                            markup.quote.inline.context
%                                        ^^^^ markup.quote.inline.context

\startquote
  consectetur adipisicing \type{elit}, sed do eiusmod {\sl tempor} incididunt
  ut labore et dolore magna aliqua.
  % <- markup.quote.block.context
\stopquote

Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
aliquip ex ea commodo consequat.

\startquotation
  Duis aute \type[option=lua]{\irure} dolor in reprehenderit {\it in} voluptate
  velit esse cillum dolore eu fugiat nulla pariatur.
  % <- markup.quote.block.context
\stopquotation

\stoptext
% <- support.function.general.context
